<style>
  .tab {
    display: none;
  }
  .step {
    height: 10px;
    width: 10px;
    margin: 0 2px;
    background-color: #bbbbbb;
    border: none;
    border-radius: 50%;
    display: inline-block;
    opacity: 0.5;
  }
  .step.active {
    opacity: 1;
  }
  .step.finish {
    background-color: #4caf50;
  }

  body {
    font-size: 0.85rem;
  }
  .form-control {
    border: 1px solid #9e9e9e !important;
    box-shadow: none !important;
    padding: 3px 6px !important;
    font-size: 0.85rem;
  }
  .form-check-input {
    border-color: #737373 !important;
    width: 0.9em;
    height: 0.9em;
  }
  .form-check-input:checked {
    background-color: #000000 !important;
    border-color: #000000 !important;
  }
  label,
  .form-check-label {
    font-size: 0.85rem;
  }
  h4 {
    font-size: 1rem;
    margin-top: 0.5rem !important;
    margin-bottom: 0.5rem !important;
  }
  .mb-3 {
    margin-bottom: 0.5rem !important;
  }
  .mt-4 {
    margin-top: 0.5rem !important;
  }
  .card {
    margin-bottom: 0.75rem !important;
    padding: 1rem !important;
  }
  .btn {
    font-size: 0.85rem;
    padding: 0.3rem 0.75rem;
  }
  .warning-text {
    color: red;
  }
  .file-upload-group {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }

  .file-upload-group label {
    width: 80px; /* Set a consistent label width */
    color: red; /* Applies your 'warning-text' style */
    margin-right: 10px;
  }

  .form-control-file {
    flex: 1; /* Allows input to take remaining space */
  }
  .file-upload-group {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }

  .file-upload-group label {
    width: 220px; /* Adjust width to fit longest label */
    color: red;
    margin-right: 10px;
  }

  .form-control-file {
    flex: 1;
  }
</style>
<div class="container mt-5">
  <div class="card">
    <div class="card-header card-header-primary">
      <h4 class="card-title" style="margin-bottom: 0.3rem">Register</h4>
      <p class="card-category" style="margin-bottom: 0.3rem">
        Complete your registration application
      </p>
      <p style="color: firebrick; margin-top: 0.3rem">
        <b>
          <i>
            Please fill the complete form. Fields with "*" are mandatory to
            fill. If you do not know the answer of any field, you can put "Not
            Applicable" or "NA"
          </i>
        </b>
      </p>
    </div>
    <div class="card-body">
      <form id="regForm" onsubmit="return false;">
        <!-- Step 1 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 1. Personal Information -->
            <h4>Personal Information</h4>
            <!-- Thumbnail Image (50x50px) -->
            <img
              alt="Passport Photo"
              class="img-thumbnail mt-3"
              data-bs-target="#zoomModal"
              data-bs-toggle="modal"
              id="thumbnailImage"
              src="../../assets/img/passportsized.jpg"
              style="
                width: 50px;
                height: 50px;
                object-fit: cover;
                cursor: pointer;
              "
            />
            <p>Upload passport sized photo</p>
            <!-- Modal for Zoomed Image -->
            <div class="modal fade" id="zoomModal" tabindex="-1">
              <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                  <div class="modal-body text-center">
                    <img
                      alt="Zoomed Passport Photo"
                      id="zoomedImage"
                      src="../../assets/img/passportsized.jpg"
                      style="max-width: 30%; height: auto"
                    />
                  </div>
                </div>
              </div>
            </div>
            <div>
              <input
                accept="image/png, image/jpeg"
                class="form-control"
                id="passportSized"
                style="max-width: 30%"
                type="file"
              />
              <small class="text-danger mt-1 d-block">
                Accepted formats: JPG, PNG. Max size: 1MB.
                <span style="color: rgb(0, 0, 0)">
                  <b> IMAGE SIZE: 217px x 280px BACKGROUND : WHITE </b>
                </span>
              </small>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label" for="full_name_student">
                Full Name
              </label>
              <input class="form-control" id="full_name_student" type="text" />
            </div>
            <div class="col-md-6">
              <label class="form-label" for="ic_no">
                IC Number / Passport Number
              </label>
              <input class="form-control" id="ic_no" type="text" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label d-block"> Gender </label>
              <div class="form-check form-check-inline" id="gender">
                <input
                  class="form-check-input"
                  name="gender"
                  type="radio"
                  value="Male"
                />
                <label class="form-check-label"> Male </label>
              </div>
              <div class="form-check form-check-inline col-md-4 mb-3">
                <input
                  class="form-check-input"
                  name="gender"
                  type="radio"
                  value="Female"
                />
                <label class="form-check-label"> Female </label>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label> Date of Birth </label>
              <input class="form-control" id="dob" type="date" />
            </div>
            <div class="col-md-6 mb-3">
              <label for="nationality"> Nationality </label>
              <select class="form-control" id="nationality">
                <option disabled="" selected="" value="">
                  Select Nationality
                </option>
                <option value="Malaysian">Malaysian</option>
                <option value="NonMalaysian">Non-Malaysian</option>
              </select>
              <!-- Hidden by default -->
              <div class="mt-2" id="nonMalaysianInput" style="display: none">
                <input
                  class="form-control"
                  id="Non_Malaysian"
                  placeholder="Please specify your nationality"
                  type="text"
                  value="-"
                />
              </div>
            </div>
            <!--Race-->
            <div class="col-md-6 mb-3">
              <label for="race"> Race </label>
              <select class="form-control" id="race">
                <option disabled="" selected="" value="">Select Race</option>
                <option value="Malay">Malays</option>
                <option value="China">Chinese</option>
                <option value="India">Indians</option>
                <option value="Others">Others</option>
                <!-- Add more countries as needed -->
              </select>
            </div>
            <!--Religion-->
            <div class="col-md-6 mb-3">
              <label for="religion"> Religion </label>
              <select class="form-control" id="religion">
                <option disabled="" selected="" value="">
                  Select Religion
                </option>
                <option value="Islam">Islam</option>
                <option value="Hindu">Hindu</option>
                <option value="Buddha">Buddhist</option>
                <option value="Christian">Christian</option>
                <option value="Others">Others</option>
                <!-- Add more countries as needed -->
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label> Email Address </label>
              <input class="form-control" id="email" type="email" />
            </div>
            <div class="col-md-6 mb-3">
              <label> Contact Number </label>
              <input class="form-control" id="phone" type="text" />
            </div>
            <div class="col-md-6 mb-3">
              <label> Place of Birth </label>
              <input class="form-control" id="PlaceofBirth" type="text" />
            </div>
            <div class="col-md-6 mb-3">
              <label> Emergency Contact Name </label>
              <input class="form-control" id="emergency_contact" type="text" />
            </div>
            <div class="col-md-6 mb-3">
              <label> Emergency Contact Number </label>
              <input
                class="form-control"
                id="emergency_contact_No"
                type="text"
              />
            </div>
          </div>
        </div>
        <!-- Step 2 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 2. Address Information -->
            <h4 class="mt-4">Address Information</h4>
            <div class="row">
              <div class="col-md-12 mb-3">
                <label> Permanent Address </label>
                <input class="form-control" id="P_address" type="text" />
              </div>
              <div class="col-md-4 mb-3">
                <label> City </label>
                <input class="form-control" id="P_city" type="text" />
              </div>
              <div class="col-md-4 mb-3">
                <label> Postcode </label>
                <input class="form-control" id="P_postcode" type="text" />
              </div>
              <div class="col-md-4 mb-3">
                <label> State </label>
                <input class="form-control" id="P_state" type="text" />
              </div>
              <div class="col-md-4 mb-3">
                <label> Country </label>
                <input class="form-control" id="P_country" type="text" />
              </div>
              <div class="col-md-6 mb-3">
                <label> Phone Number (if different) </label>
                <input class="form-control" id="P_different_no" type="text" />
              </div>
            </div>
          </div>
        </div>
        <!-- Step 3 -->
        <div class="tab">
          <div class="card p-4">
            <!-- Program Applied For -->
            <div class="col-md-6 mb-3">
              <label for="programstatus">Program Applied For</label>
              <select
                class="form-control"
                id="programstatus"
                onchange="handleProgramChange()"
              >
                <option disabled selected value="">
                  Select Program Status
                </option>
                <option disabled value="diploma">Diploma</option>
                <option value="degree">Bachelor's Degree</option>
                <option value="mastercoursework">Master's (Coursework)</option>
                <option value="masterresearch">Master's (Research)</option>
                <option value="phd">PhD (Research)</option>
                <option value="others">Others</option>
              </select>
            </div>

            <!-- Degree: Dropdown -->
            <div
              class="col-md-6 mb-3"
              id="programNameDiv"
              style="display: none"
            >
              <label for="program_name">Program</label>
              <select class="form-control" id="program_name">
                <option disabled selected value="">Select Program</option>
                <option value="bib">
                  Bachelor of Business (International Business) with Honours
                </option>
                <option value="bee">
                  Bachelor of Electrical Engineering (Honours)
                </option>
                <option value="bnmc">
                  Bachelor of New Media Communication with Honours
                </option>
                <option value="bce">
                  Bachelor of Computer Engineering with Honours
                </option>
              </select>
            </div>

            <!-- Master's / PhD / Others: Input -->
            <div
              class="col-md-6 mb-3"
              id="customProgramDiv"
              style="display: none"
            >
              <label for="custom_program">Specify Your Program</label>
              <input
                class="form-control"
                id="custom_program"
                placeholder="Enter your program"
                type="text"
                value="-"
              />
            </div>

            <!-- Mode of Study -->
            <div class="col-md-6 mb-3">
              <label class="form-label d-block">Mode of Study</label>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  name="studyMode"
                  type="radio"
                  value="Full-Time"
                  checked
                />
                <label class="form-check-label">Full-Time</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  name="studyMode"
                  type="radio"
                  value="Part-Time"
                  disabled
                />
                <label class="form-check-label">Part-Time</label>
              </div>
            </div>

            <!-- Intake Year -->
            <div class="col-md-6 mb-3">
              <label for="Intakeyear">Intake</label>
              <select class="form-control" id="Intakeyear">
                <option disabled selected value="">Select Year</option>
                <option value="2023">2023</option>
                <option value="2024">2024</option>
                <option value="2025">2025</option>
                <option value="2026">2026</option>
                <option value="2027">2027</option>
                <option value="2028">2028</option>
                <option value="2029">2029</option>
                <option value="2030">2030</option>
              </select>
            </div>

            <!-- Semester -->
            <div class="col-md-6 mb-3">
              <label class="form-label d-block">Semester</label>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  name="semester"
                  type="radio"
                  value="March"
                />
                <label class="form-check-label">March</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  name="semester"
                  type="radio"
                  value="October"
                />
                <label class="form-check-label">October</label>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 4 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 4. Academic Qualifications -->
            <h4 class="mt-4">Academic Qualifications</h4>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="hqo"> Highest Qualification Obtained </label>
                <select class="form-control" id="H_Qualification">
                  <option disabled="" selected="" value="select">
                    Select Qualification
                  </option>
                  <option value="PMR">PMR</option>
                  <option value="SPM">SPM</option>
                  <option value="STPM">STPM</option>
                  <option value="FOUNDATION">Foundation</option>
                  <option value="MATRICULATION">
                    Pre-University Programme (Matriculation)
                  </option>
                  <option value="DIPLOMA">Diploma</option>
                  <option value="DEGREE">Degree</option>
                  <option value="MASTER">Master</option>
                  <option value="PhD">PhD</option>
                  <option value="A-LEVEL">A-Level</option>
                  <option value="HIGHSCHOOL">High-School(Foreign)</option>
                  <option value="OTHERS">Others</option>
                  <!-- Add more countries as needed -->
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label> Institution Name </label>
                <input class="form-control" id="institution_name" type="text" />
              </div>
              <div class="col-md-6 mb-3">
                <label> Country of Institution </label>
                <input
                  class="form-control"
                  id="Institution_country"
                  type="text"
                />
              </div>
              <div class="col-md-6 mb-3">
                <label> Year of Graduation </label>
                <input class="form-control" id="Year_grad" type="text" />
              </div>
              <!-- Certificate -->
              <div class="file-upload-group">
                <label for="ResultQualification"
                  >Academic Transcript (Notarized)</label
                >
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="ResultQualification"
                  type="file"
                />
              </div>

              <div class="file-upload-group">
                <label for="Certificate_completion_studies"
                  >Certificate Graduation</label
                >
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="Certificate_completion_studies"
                  type="file"
                />
              </div>
              <div>
                <p>
                  <b><i>This part compulsory for China student only.</i></b>
                </p>
              </div>
              <div class="file-upload-group">
                <label for="chsi">CHSI</label>
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="chsi"
                  type="file"
                />
              </div>

              <div class="file-upload-group">
                <label for="cshse">CSHSE</label>
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="cscse"
                  type="file"
                />
              </div>
            </div>
          </div>
        </div>
        <!-- Step 5 -->
        <div class="tab">
          <div class="card p-4">
            <h4 class="mt-4">Previous Education</h4>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label> Secondary School Name </label>
                <input class="form-control" id="secondary_name" type="text" />
              </div>
              <div class="col-md-6 mb-3">
                <label> Secondary School Address </label>
                <input
                  class="form-control"
                  id="secondary_address"
                  type="text"
                />
              </div>
              <div class="col-md-6 mb-3">
                <label for="hqo"> Qualification </label>
                <select class="form-control" id="secondary_qualification">
                  <option disabled="" selected="" value="">
                    Select Qualification
                  </option>

                  <option value="PMR">PMR</option>
                  <option value="SPM">SPM</option>
                  <option value="STPM">STPM</option>
                  <option value="FOUNDATION">Foundation</option>
                  <option value="MATRICULATION">
                    Pre-University Programme (Matriculation)
                  </option>
                  <option value="DIPLOMA">Diploma</option>
                  <option value="DEGREE">Degree</option>
                  <option value="MASTER">Master</option>
                  <option value="PhD">PhD</option>
                  <option value="A-LEVEL">A-Level</option>
                  <option value="HIGHSCHOOL">High-School(Foreign)</option>
                  <option value="OTHERS">Others</option>
                  <!-- Add more countries as needed -->
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label> Country of Institution </label>
                <input
                  class="form-control"
                  id="secondary_country"
                  type="text"
                />
              </div>
              <div class="col-md-6 mb-3">
                <label> Year of Graduation </label>
                <input class="form-control" id="year_gradschool" type="text" />
              </div>
              <div class="file-upload-group">
                <label for="ResultQualification"
                  >Academic Transcript (Notarized)</label
                >
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="Cert_sec_stud"
                  type="file"
                />
              </div>

              <div class="file-upload-group">
                <label for="Certificate_completion_studies"
                  >Certificate Graduation</label
                >
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="graduatesecondry"
                  type="file"
                />
              </div>
            </div>
          </div>
        </div>
        <!-- Step 6 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 5. English Proficiency -->
            <h4 class="mt-4">English Proficiency</h4>
            <div class="row">
              <div class="col-md-12 mb-3">
                <label class="form-label d-block"> English Test Taken </label>
                <div class="col-md-6 mb-3">
                  <select class="form-control" id="englishTest">
                    <option disabled="" selected="" value="">
                      Select Qualification
                    </option>
                    <option value="TOEFL">TOEFL</option>
                    <option value="IELTS">IELTS</option>
                    <option value="LINGUALSKILL">LINGUALSKILL</option>
                    <option value="TESL">TESL</option>
                    <option value="MUET">MUET</option>
                    <option value="NON-ENGLISH">NON-ENGLISH</option>
                    <option value="Other">OTHERS</option>
                  </select>
                </div>
                <!-- Hidden input shown only when "Other" is selected -->
                <div
                  class="col-md-6 mb-3"
                  id="englishOtherInput"
                  style="display: none"
                >
                  <input
                    class="form-control"
                    id="english_test_other"
                    placeholder="Please specify your English test"
                    type="text"
                    value="-"
                  />
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label> Score </label>
                <input class="form-control" id="englishscore" type="text" />
              </div>
              <div class="col-md-6 mb-3">
                <label> Test Date </label>
                <input
                  class="form-control"
                  id="english_test_date"
                  type="date"
                />
              </div>
              <!-- Certificate -->
              <div class="mb-3 text-left file-upload-group">
                <!--<img src="" alt="Result" class="rounded-circle mb-3 profile-img">-->
                <label> English Result</label>
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="english_result_file"
                  type="file"
                />
                <small class="form-text text-muted" id="fileHelp"> </small>
              </div>
            </div>
          </div>
        </div>
        <!-- Step 7 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 6. Visa Information -->
            <h4 class="mt-4">Visa Information (International Students)</h4>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label d-block">
                  Require Student Visa?
                </label>
                <div class="form-check form-check-inline" id="requireVisa">
                  <input
                    class="form-check-input"
                    name="requireVisa"
                    type="radio"
                    value="Yes"
                  />
                  <label class="form-check-label"> Yes </label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    name="requireVisa"
                    type="radio"
                    value="No"
                  />
                  <label class="form-check-label"> No </label>
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label d-block"> Type of Visa </label>
                <div class="form-check form-check-inline" id="visaType">
                  <input
                    class="form-check-input"
                    name="visaType"
                    type="radio"
                    value="Student Visa"
                  />
                  <label class="form-check-label"> Student Visa </label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    name="visaType"
                    type="radio"
                    value="Dependent Visa"
                  />
                  <label class="form-check-label"> Dependent Visa </label>
                </div>
              </div>
              <!-- <div class="col-md-6 mb-3">
                <label> Social </label>
                <input class="form-control" id="visa_expiry" type="date" />
              </div> -->
              <div class="col-md-6 mb-3">
                <label> Passport Expiry Date </label>
                <input class="form-control" id="passport_expiry" type="date" />
              </div>
              <!-- Thumbnail Image and File Input -->
              <div class="mb-3">
                <p>
                  <b>
                    Requires a clear copy of all pages of student/applicant
                    international passport (including blank pages) for
                    registration and documentation purposes. Please ensure the
                    copy is complete, clear, and in PDF format. You may upload
                    through the registration portal.
                  </b>
                </p>
                <label class="form-label">
                  <i
                    >Kindly download the passport sample that you are going to
                    upload here.</i
                  >
                </label>
                <a
                  class="btn btn-outline-primary mt-2"
                  download=""
                  href="../../docs/Example Passport requirement.pdf"
                  target="_blank"
                >
                  📄 Passport Submission sample
                </a>
              </div>
              <div file-upload-group>
                <label style="color: red"> Upload Passport</label>
                <input
                  class="form-control-file"
                  id="Passport_FPage"
                  type="file"
                  accept="application/pdf"
                />
              </div>
            </div>
          </div>
        </div>
        <!-- Step 8 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 8. Health Information -->
            <h4 class="mt-4">Health Information</h4>
            <div class="row">
              <div class="mb-3">
                <label class="form-label">
                  Please download the health declaration form, fill it out, and
                  upload it here.
                </label>
                <br />
                <a
                  class="btn btn-outline-primary mt-2"
                  download=""
                  href="../../docs/Form A - Health Declaration Form For Applicant (PW).pdf"
                  target="_blank"
                >
                  📄 Download Health Declaration Form
                </a>
                <div class="mb-3 text-left">
                  <!--<img src="" alt="Result" class="rounded-circle mb-3 profile-img">-->
                  <label>
                    Upload Here after you fill up the health Application
                  </label>
                  <input
                    accept=".jpg, .jpeg, .png"
                    class="form-control-file"
                    id="Healthdeclare_file"
                    type="file"
                  />
                </div>
                <!-- Medical Conditions -->
                <div class="col-md-6 mb-3">
                  <label class="form-label d-block">
                    Any known medical conditions?
                  </label>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-check-input"
                      id="medicalYes"
                      name="medicalConditions"
                      onclick="handleMedicationChangeYes()"
                      type="radio"
                      value="Yes"
                    />
                    <label class="form-check-label" for="medicalYes">
                      Yes
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-check-input"
                      id="medicalNo"
                      name="medicalConditions"
                      onclick="handleMedicationChangeNo()"
                      type="radio"
                      value="No"
                    />
                    <label class="form-check-label" for="medicalNo"> No </label>
                  </div>
                  <div
                    class="mt-2"
                    id="medicationSpecifyDiv"
                    style="display: none"
                  >
                    <input
                      class="form-control"
                      id="specifycondition"
                      placeholder="If yes, please specify"
                      type="text"
                    />
                  </div>
                  <label class="form-label d-block">
                    Are you on any current medication?
                  </label>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-check-input"
                      id="current_medicationYes"
                      name="current_medication"
                      onclick="handleCurrentMedicationChangeYes()"
                      type="radio"
                      value="Yes"
                    />
                    <label class="form-check-label" for="current_medicationYes">
                      Yes
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input
                      class="form-check-input"
                      id="current_medicationNo"
                      name="current_medication"
                      onclick="handleCurrentMedicationChangeNo()"
                      type="radio"
                      value="No"
                    />
                    <label class="form-check-label" for="current_medicationNo">
                      No
                    </label>
                  </div>
                  <div
                    class="mt-2"
                    id="CurrentMedicationSpecifyDiv"
                    style="display: none"
                  >
                    <input
                      class="form-control"
                      id="current_medicationspecifycurrent"
                      placeholder="If yes, please specify"
                      type="text"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Step 9 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 10. Parent/Guardian Information -->
            <h4 class="mt-4">Parent/Guardian Information</h4>
            <div class="row">
              <!-- Father's Details -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label>Father's/Guardian's Name</label>
                  <input class="form-control" id="Father_name" type="text" />
                </div>
                <div class="mb-3">
                  <label>Occupation</label>
                  <input
                    class="form-control"
                    id="Father_Occupation"
                    type="text"
                  />
                </div>
                <div class="mb-3">
                  <label>Phone Number</label>
                  <input class="form-control" id="ContactFather" type="text" />
                </div>
              </div>

              <!-- Mother's Details -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label>Mother's/Guardian's Name</label>
                  <input class="form-control" id="Mother_name" type="text" />
                </div>
                <div class="mb-3">
                  <label>Occupation</label>
                  <input
                    class="form-control"
                    id="Mother_Occupation"
                    type="text"
                  />
                </div>
                <div class="mb-3">
                  <label>Phone Number</label>
                  <input class="form-control" id="Mother_Phone" type="text" />
                </div>
              </div>

              <div class="mb-3 text-left file-upload-group">
                <label> Parents Income slip </label>
                <input
                  accept=".jpg, .jpeg, .png"
                  class="form-control-file"
                  id="parentslip_payment"
                  type="file"
                />
              </div>
            </div>
          </div>
        </div>
        <!-- Step 10 -->
        <div class="tab">
          <div class="card p-4">
            <h4 class="mt-4">PAYMENT RECEIPT</h4>
            <div class="row">
              <div class="col-md-12 mb-3">
                <label>
                  After applicant makes a payment of MYR128.00, please upload
                  the receipt here.
                </label>
                <label>
                  Payment must be made to the account —
                  <strong>GRAND INTERMAP: Maybank 564191599569</strong>
                  <img
                    src="../../assets/img/maybank-logo-png-transparent.png"
                    style="width: 100px; height: auto"
                  />
                  <img
                    src="../../assets/img/WCPay.png"
                    style="width: 70px; height: auto"
                  />
                </label>

                <!-- Thumbnail and file upload -->
                <div class="mb-3 text-left">
                  <img
                    alt="QR PAY"
                    class="mb-3 profile-img img-thumbnail zoomable"
                    data-bs-toggle="modal"
                    data-bs-target="#zoomModalPayment"
                    src="../../assets/img/QR Grand InterMAP.jpg"
                    style="width: 50px; cursor: pointer"
                    onclick="document.getElementById('zoomedImage').src = this.src"
                  />
                  <input
                    class="form-control-file"
                    id="payment_receipt_file"
                    type="file"
                  />
                </div>

                <!-- Modal -->
                <div
                  class="modal fade"
                  id="zoomModalPayment"
                  tabindex="-1"
                  aria-labelledby="zoomModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                      <div class="modal-body text-center">
                        <img
                          id="zoomedImage"
                          alt="Zoomed Image"
                          class="img-fluid"
                          src="../../assets/img/QR Grand InterMAP.jpg"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Step 11 -->
        <div class="tab">
          <div class="card p-4">
            <!-- 10. Declaration -->
            <h4 class="mt-4">Declaration</h4>
            <div class="form-check mb-3">
              <input
                class="form-check-input"
                id="declarationCheck"
                required=""
                type="checkbox"
              />
              <label class="form-check-label" for="declarationCheck">
                I declare that the information provided is accurate.
              </label>
            </div>
            <div class="col-md-6 mb-3">
              <label> Date </label>
              <input class="form-control" id="datesign" type="date" />
            </div>
            <div class="col-md-6 mb-3">
              <label> Signature of Parent/Guardian (if applicable) </label>
              <input class="form-control" id="sign_parents" type="text" />
            </div>
          </div>
        </div>
        <!-- Navigation Buttons -->
        <div class="mt-4">
          <button
            class="btn btn-secondary"
            id="prevBtn"
            onclick="nextPrev(-1)"
            type="button"
          >
            Previous
          </button>
          <button
            class="btn btn-secondary"
            id="nextBtn"
            onclick="nextPrev(1)"
            type="button"
          >
            Next
          </button>
        </div>
        <!-- Step Indicators -->
        <div class="text-center mt-3">
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
          <span class="step"> </span>
        </div>
      </form>
    </div>
  </div>
</div>
<script>
  var currentTab = 0;
  showTab(currentTab);
  let formData = {};
  let data1,
    data2,
    data3,
    data4,
    data5,
    data6,
    data7,
    data8,
    data9,
    data10,
    data11 = {};

  function showTab(n) {
    var x = document.getElementsByClassName("tab");
    x[n].style.display = "block";
    if (n == 0) {
      document.getElementById("prevBtn").style.display = "none";
    } else {
      document.getElementById("prevBtn").style.display = "inline";
    }
    if (n == x.length - 1) {
      document.getElementById("nextBtn").innerHTML = "Submit";
    } else {
      document.getElementById("nextBtn").innerHTML = "Next";
    }
    fixStepIndicator(n);
  }

  async function nextPrev(n) {
    var x = document.getElementsByClassName("tab");

    // Exit if invalid
    if (n == 1 && !validateForm()) return false;
    // alert("test2");
    // ✅ Save data from current tab before switching
    saveCurrentTabData(currentTab);

    // Hide current tab
    x[currentTab].style.display = "none";

    // Move to next or previous
    currentTab = currentTab + n;

    // If last step, submit the form
    if (currentTab >= x.length) {
      const storedLoginDetail = JSON.parse(
        sessionStorage.getItem("loginDetail")
      );

      if (storedLoginDetail) {
        formData = {
          register_by: storedLoginDetail.full_name,
        };
      }

      const combined = {
        ...data1,
        ...data2,
        ...data3,
        ...data4,
        ...data5,
        ...data6,
        ...data7,
        ...data8,
        ...data9,
        ...data10,
        ...data11,
        ...formData,
      };

      console.log("Final combined data:", combined); // for debugging

      const { error } = await supabase
        .from("student_applications")
        .insert([combined]);

      if (error) {
        alert("Error saving application: " + error.message);
      } else {
        alert("Application saved successfully!");
        document.getElementById("regForm").reset();
      }
      return true;
    }

    // Show next tab
    showTab(currentTab);
  }

  function toBase64(file) {
    console.log("hit");
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.readAsDataURL(file);
      reader.onload = () => resolve(reader.result); // includes data:image/... prefix
      reader.onerror = (error) => reject(error);
    });
  }

  async function saveCurrentTabData(tabIndex) {
    const tab = document.getElementsByClassName("tab")[tabIndex];
    const inputs = tab.getElementsByTagName("input");
    console.log("tabIndex", tabIndex);
    if (tabIndex === 0) {
      const fileInput = document.getElementById("passportSized");
      const file = fileInput ? fileInput.files[0] : null;

      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      data1 = {
        profile_photo: base64Image,
        full_name: document.getElementById("full_name_student").value,
        gender:
          document.querySelector('input[name="gender"]:checked')?.value || null,
        ic_or_passport: document.getElementById("ic_no").value,
        date_of_birth: document.getElementById("dob").value,
        nationality: document.getElementById("nationality").value,
        nonMalaysianInput: document.getElementById("Non_Malaysian").value,
        race: document.getElementById("race").value,
        religion: document.getElementById("religion").value,
        contact_number: document.getElementById("phone").value,
        email: document.querySelector('input[type="email"]').value,
        birth_place: document.getElementById("PlaceofBirth").value,
        emergency_contact_name:
          document.getElementById("emergency_contact").value,
        emergency_contact_number: document.getElementById(
          "emergency_contact_No"
        ).value,
      };
    } else if (tabIndex === 1) {
      data2 = {
        // PERMANENT ADDRESS
        permanent_address: document.getElementById("P_address").value,
        permanent_city: document.getElementById("P_city").value,
        permanent_postcode: document.getElementById("P_postcode").value,
        permanent_state: document.getElementById("P_state").value,
        alternate_phone_number: document.getElementById("P_different_no").value,
      };
    }
    if (tabIndex === 2) {
      const programStatus = document.getElementById("programstatus").value;
      const programName =
        programStatus === "degree"
          ? document.getElementById("program_name").value
          : document.getElementById("custom_program").value;

      data3 = {
        program_status: programStatus,
        program_name: programName || "-",
        study_mode: "Full-Time",
        intake_year: document.getElementById("Intakeyear").value,
        intake_semester:
          document.querySelector('input[name="semester"]:checked')?.value ||
          null,
      };
    } else if (tabIndex === 3) {
      const fileInput = document.getElementById("ResultQualification");
      const file = fileInput ? fileInput.files[0] : null;
      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      const fileInput2 = document.getElementById(
        "Certificate_completion_studies"
      );
      const file2 = fileInput2 ? fileInput2.files[0] : null;
      let base64Image2 = "";
      if (file2) {
        base64Image2 = await toBase64(file2);
      }

      const fileInput3 = document.getElementById("chsi");
      const file3 = fileInput3 ? fileInput3.files[0] : null;
      cscse;
      let base64Image3 = "";
      if (file3) {
        base64Image3 = await toBase64(file3);
      }

      const fileInput4 = document.getElementById("cscse");
      const file4 = fileInput4 ? fileInput4.files[0] : null;
      let base64Image4 = "";
      if (file4) {
        base64Image4 = await toBase64(file4); // ✅ fixed condition
      }

      data4 = {
        // ACADEMIC QUALIFICATION
        ResultQualification: base64Image,
        Certificate_completion_studies_file: base64Image2,
        chsi: base64Image3,
        cscse: base64Image4,

        institution_name: document.getElementById("institution_name").value,
        highest_qualification: document.getElementById("H_Qualification").value,
        institution_country: document.getElementById("Institution_country")
          .value,
        graduation_year: document.getElementById("Year_grad").value,
      };
    } else if (tabIndex === 4) {
      const fileInput = document.getElementById("graduatesecondry");
      const file = fileInput ? fileInput.files[0] : null;
      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      const fileInput2 = document.getElementById("Cert_sec_stud");
      const file2 = fileInput2 ? fileInput2.files[0] : null;
      let base64Image2 = "";
      if (file2) {
        base64Image2 = await toBase64(file2);
      }

      data5 = {
        // SECONDARY
        graduatesecondry: base64Image,
        Cert_sec_stud: base64Image,
        secondary_name: document.getElementById("secondary_name").value,
        secondary_address: document.getElementById("secondary_address").value,
        secondary_country: document.getElementById("secondary_country").value,
        secondary_qualification: document.getElementById(
          "secondary_qualification"
        ).value,
        year_gradschool: document.getElementById("year_gradschool").value,
        // secondary_school: document.getElementById("secondary_country").value,
      };
    } else if (tabIndex === 5) {
      const fileInput = document.getElementById("english_result_file");
      const file = fileInput ? fileInput.files[0] : null;

      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      data6 = {
        // ENGLISH
        english_result_file: base64Image,
        english_test: document.getElementById("englishTest").value,
        // english_test:
        //   document.querySelector('input[name="englishTest"]:checked').value ||
        //   null,
        english_test_other: document.getElementById("englishOtherInput").value,
        english_score: document.getElementById("englishscore").value,
        english_test_date: document.getElementById("english_test_date").value,
      };
    }
    if (tabIndex === 6) {
      const fileInput = document.getElementById("Passport_FPage");
      const file = fileInput ? fileInput.files[0] : null;
      let base64Image = "";

      if (file) {
        // Optional: Validate file type and size
        if (file.type !== "application/pdf") {
          alert("Only PDF files are allowed.");
          return false; // <- fix: stop submission
        }
        if (file.size > 5 * 1024 * 1024) {
          alert("PDF file size must be less than 5MB.");
          return false; // <- fix: stop submission
        }

        try {
          base64Image = await toBase64(file);
        } catch (e) {
          alert("Failed to read passport file.");
          return false;
        }
      }

      data7 = {
        Passport_FPage: base64Image,
        require_visa:
          document.querySelector('input[name="requireVisa"]:checked')?.value ||
          null,
        visa_type:
          document.querySelector('input[name="visaType"]:checked')?.value ||
          null,
        passport_expiry: document.getElementById("passport_expiry").value,
      };
    } else if (tabIndex === 7) {
      const fileInput = document.getElementById("Healthdeclare_file");
      const file = fileInput ? fileInput.files[0] : null;
      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      data8 = {
        // HEALTH INFORMATION
        Healthdeclare_file: base64Image,
        medicalConditions:
          document.querySelector('input[name="medicalConditions"]:checked')
            ?.value || null,
        specifycondition:
          document.getElementById("specifycondition")?.value || "-",
        current_medication:
          document.querySelector('input[name="current_medication"]:checked')
            ?.value || null,
        specifycurrent:
          document.getElementById("current_medicationspecifycurrent")?.value ||
          "-",
      };
    } else if (tabIndex === 8) {
      const fileInput = document.getElementById("parentslip_payment");
      const file = fileInput ? fileInput.files[0] : null;
      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      data9 = {
        // PARENTS GUARDIAN
        parents_income: base64Image,
        father_name: document.getElementById("Father_name").value,
        mother_name: document.getElementById("Mother_name").value,
        father_phone: document.getElementById("ContactFather").value,
        father_occupation: document.getElementById("Father_Occupation").value,
        mother_occupation: document.getElementById("Mother_Occupation").value,
        mother_phone: document.getElementById("Mother_Phone").value,
        // parents_income: base64Image,
      };
    } else if (tabIndex === 9) {
      const fileInput = document.getElementById("payment_receipt_file");
      const file = fileInput ? fileInput.files[0] : null;
      let base64Image = "";
      if (file) {
        base64Image = await toBase64(file);
      }

      data10 = {
        payment_receipt_file: base64Image,
      };
    } else if (tabIndex === 10) {
      const checkbox = document.getElementById("declarationCheck");
      const isChecked = checkbox.checked;

      data11 = {
        // DECLARATION
        declaration_checked: isChecked,
        declaration_date: document.getElementById("datesign").value,
        declaration_signature: document.getElementById("sign_parents").value,
      };
    }
  }
  function validateForm() {
    var x,
      y,
      i,
      valid = true;
    x = document.getElementsByClassName("tab");
    y = x[currentTab].getElementsByTagName("input");

    for (i = 0; i < y.length; i++) {
      if (y[i].value == "") {
        if (y[i].id === "cscse") {
          return valid;
        } else if (y[i].id === "chsi") {
          return valid;
        } else if (y[i].value == "english_result_file") {
          return valid;
        } else if (y[i].value == "Cert_sec_stud") {
          return valid;
        } else if (y[i].value == "graduatesecondry") {
          return valid;
        } else {
          y[i].className += " is-invalid";
          valid = false;
        }
      } else {
        y[i].className = y[i].className.replace(" is-invalid", "");
      }
    }
    if (valid) {
      document.getElementsByClassName("step")[currentTab].className +=
        " finish";
    }
    return valid;
  }

  function fixStepIndicator(n) {
    var i,
      x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) {
      x[i].className = x[i].className.replace(" active", "");
    }
    x[n].className += " active";
  }

  // Initialize flatpickr
  flatpickr("#dob", {
    dateFormat: "Y-m-d", // Set date format
    minDate: "1900-01-01", // Minimum selectable date
    maxDate: "today", // Maximum selectable date
  });
</script>
<script>
  function handleProgramChange() {
    const selected = document.getElementById("programstatus").value;
    const programNameDiv = document.getElementById("programNameDiv");
    const customProgramDiv = document.getElementById("customProgramDiv");
    const programSelect = document.getElementById("program_name");
    const customInput = document.getElementById("custom_program");

    if (selected === "degree") {
      programNameDiv.style.display = "block";
      customProgramDiv.style.display = "none";
      programSelect.value = "";
      customInput.value = "-";
    } else if (
      ["mastercoursework", "masterresearch", "phd", "others"].includes(selected)
    ) {
      programNameDiv.style.display = "none";
      customProgramDiv.style.display = "block";
      programSelect.value = "";
      customInput.value = "";
    } else {
      programNameDiv.style.display = "none";
      customProgramDiv.style.display = "none";
      programSelect.value = "";
      customInput.value = "-";
    }
  }
</script>

<script>
  document
    .getElementById("nationality")
    .addEventListener("change", function () {
      const inputDiv = document.getElementById("nonMalaysianInput");
      const input = document.getElementById("Non_Malaysian");
      if (this.value === "NonMalaysian") {
        inputDiv.style.display = "block";
        input.value = "Please specify your country";
      } else {
        inputDiv.style.display = "none";
        input.value = "-";
      }
    });
</script>
<script>
  document
    .getElementById("englishTest")
    .addEventListener("change", function () {
      const inputDiv = document.getElementById("englishOtherInput");
      const input = document.getElementById("Other");

      if (this.value === "Other") {
        inputDiv.style.display = "block";
        input.value = "Please Specify";
      } else {
        inputDiv.style.display = "none";
        input.value = "-";
      }
    });
</script>

<script>
  function handleProgramChange() {
    const selected = document.getElementById("programstatus").value;
    const programNameDiv = document.getElementById("programNameDiv");
    const customProgramDiv = document.getElementById("customProgramDiv");
    const programSelect = document.getElementById("program_name");
    const customInput = document.getElementById("custom_program");

    if (selected === "degree") {
      programNameDiv.style.display = "block";
      customProgramDiv.style.display = "none";
      customInput.value = "-"; // Clear hidden field
    } else if (
      ["mastercoursework", "masterresearch", "phd", "others"].includes(selected)
    ) {
      programNameDiv.style.display = "none";
      customProgramDiv.style.display = "block";
      programSelect.value = ""; // Clear hidden field
      customInput.value = "";
    } else {
      programNameDiv.style.display = "none";
      customProgramDiv.style.display = "none";
      // programSelect.value = "";
      customInput.value = "";
    }
  }

  function handleMedicationChangeYes() {
    const specifyDiv = document.getElementById("medicationSpecifyDiv");
    specifyDiv.style.display = "block";
  }

  function handleMedicationChangeNo() {
    const specifyDiv = document.getElementById("medicationSpecifyDiv");
    specifyDiv.style.display = "none";
    const input = document.getElementById("specifycondition");
    input.value = "-";
  }

  function handleCurrentMedicationChangeYes() {
    const div = document.getElementById("CurrentMedicationSpecifyDiv");
    div.style.display = "block";
  }

  function handleCurrentMedicationChangeNo() {
    const div = document.getElementById("CurrentMedicationSpecifyDiv");
    div.style.display = "none";
    const input = document.getElementById("current_medicationspecifycurrent");
    input.value = "-";
  }
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const yesRadio = document.getElementById("medicationYes");
    const noRadio = document.getElementById("medicationNo");
    const specifyDiv = document.getElementById("medicationSpecifyDiv");
    const specifyInput = document.getElementById("specifycurrent");
    const yesCRadio = document.getElementById("current_medicationYes");
    const noCRadio = document.getElementById("current_medicationNo");
    const currentspecifyDiv = document.getElementById(
      "CurrentmedicationSpecifyDiv"
    );
    const specifycurrentInput = document.getElementById(
      "current_medicationspecifycurrent"
    );

    // Show input if "Yes" is selected
    yesRadio.addEventListener("change", function () {
      if (yesRadio.checked) {
        specifyDiv.style.display = "block";
        specifyInput.setAttribute("required", "required");
      }
    });

    // Hide input if "No" is selected
    noRadio.addEventListener("change", function () {
      if (noRadio.checked) {
        specifyInput.removeAttribute("required"); // Remove required
        specifyDiv.style.display = "none"; // Hide input
        specifyInput.value = ""; // Optional: clear value
      }
    });

    // Show input if "Yes" is selected
    yesCRadio.addEventListener("change", function () {
      if (yesCRadio.checked) {
        specifycurrentInput.style.display = "block";
        specifycurrentInput.setAttribute("required", "required");
      }
    });

    // Hide input if "No" is selected
    noCRadio.addEventListener("change", function () {
      if (noCRadio.checked) {
        specifycurrentInput.removeAttribute("required"); // Remove required
        currentspecifyDiv.style.display = "none"; // Hide input
        specifycurrentInput.value = ""; // Clear the input, not the div
      }
    });
  });
</script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> -->
<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
